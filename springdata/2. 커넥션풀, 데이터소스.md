# 커넥션 풀과 데이터 소스
db 커넥션을 획득할 때 과정
- 어플에서 db 드라이버를 통해 커넥션을 조회
- db 드라이버는 db와 tcp/ip 커넥션을 연결 -> 3 way handshake 같은 tcp/ip 연결을 통한 네트워크 동작 발생
- 연결이 되면, ip, pw, 기타 정보를 db에 전달
- 커넥션 생성이 완료됐다는 응답을 보냄
- db 드라이버는 커넥션 객체를 생성해서 클라언트에 반환
</br>
과정도 복잡하고 리소스 소모가 큼
## 커넥션 풀
커넥션을 미리 생성해두고 사용함
- 어플을 시작하는 시점에 커넥션 풀은 필요한 칸큼 커넥션을 미리 확보해서 풀에 보관
  - 보통 10개 정도
- 커넥션 풀에 들어 있는 커넥션은 바로 db와 연결돼있는 상태이기 때문에 즉시 sql 전달 가능

### 커넥션 풀 사용
- 커넥션을 모두 사용한 후 커넥션을 전달하는 것이 아니라, 다음에 다시 사용할 수 있도록 해당 커넥션을 그대로 커넥션 풀에 반환
  - 커넥션이 살아있는 상태로 커넥션 풀에 반환해야함.
- 어플은 별도의 스레드를 사용해서 커넥션 풀을 채움 <- 어플의 실행시간에 영향을 주지 않기 위함.
### 정리
- 적절한 커넥션 풀 숫자는 성능 테스트를 통해서 정해야 함.
- 커넥션 풀은 서버당 최대 커넥션 수를 제한할 수 있어야함
- 오픈소스를 많이 사용

## 데이터 소스
DriverManager를 통해 커넥션을 획득하다 커넥션 풀로 변경하는 경우 코드를 모두 변경해야 함.

### DataSource
- 커넥션을 획득하는 방법을 추상화한 인터페이스
- 개발자는 DataSource에만 의존하도록 애플리케이션 로직을 구성하면 됨
- DriverManager는 DataSource 인터페이스를 사용하지 않기 때문에 DriverManagerDataSource라는 클래스를 제공





