# 빈 스코프

- 빈이 존재할 수 있는 범위.

### 종류

- 싱글톤
    - 기본 스코프, 스프링 컨테이너의 시작과 종료까지 유지되는 가장 넓은 범위의 스코프
- 프로토타입
    - 프로토타입 빈의 생성과 의존관계 주입까지만 관여하고, 더는 관리하지 않는 매우 짧은 스코프
- 웹 관련 스코프

```java
@Scope("prototype")
@Component

@Scope("prototype")
@Bean
```

## 프로토타입 스코프

- 스프링 컨테이너에서 조회하면 항상 새로운 인스턴트에서 생성해서 반환
- 스프링 컨테이너는 프로토탑입 빈을 생성하고, 의존관계 주입, 초기화까지만 처리
    - @PreDestory같은 종료 메서드가 호출되지 않음.
- 주입 시점에 새로 생성되는 것이자, 사용할 때마다 새로 생성되는 것이 아님.

## 웹 스코프

- 웹 환경에서만 동작
- 해당 스코프의 종료시점까지 관리, 종료 메서드가 호출

### 종류

- request
    - http 요청 하나가 들어오고 나갈 때 까지 유지되는 스코프, 각각의 http 요청마다 별도의 빈 인스턴스가 생성되고 관리.
    - 실제 요청이 와야 빈이 생성가능
- session
    - http session과 동일한 생명주기를 가지는 스코프
- application
    - 서블릿 컨텍스트와 동일한 생명주기를 가지는 스코프
- websocket
    - 웹 소켓과 동일한 생명주기를 가지는 스코프

```java
@Component
@Scope(value="request")

@Component
@Scope(value="request", proxyMode=ScopedProxyMode.TARGET_CLASS)
```

- 프록시 모드로 사용할 경우, 가짜 프록시 객체를 만들어 주입

- 스프링 컨테이너는 CGLIB라는 바이트코드를 조작하는 라이브러리를 사용해서, 가짜 프록시 객체를 생성

- 진짜 객체 조회를 꼭 필요한 시점까지 지연 처리

  